<common:ViewBase
    x:Name="pageRoot"
    x:Class="BudgetManager.WindowsBudget.Views.Statistic.Statistic"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:BudgetManager.WindowsBudget.Views.Statistic"
    xmlns:common="using:BudgetManager.WindowsBudget.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:chart="using:De.TorstenMandelkow.MetroChart"  
    xmlns:VM="using:BudgetManager.Shared"
    xmlns:Winrt="using:WinRTXamlToolkit.Controls"
    xmlns:converter="using:BudgetManager.Core.Converters"
    DataContext="{Binding Source={StaticResource Locator}, Path=StatisticViewModel}"   
    xmlns:datavis="using:WinRTXamlToolkit.Controls.DataVisualization"  
    xmlns:charting="using:WinRTXamlToolkit.Controls.DataVisualization.Charting" 
    xmlns:datepicker="using:StoreAppLib.Controls"
    xmlns:controls="using:BudgetManager.WindowsBudget.Views.Controls"
    mc:Ignorable="d">

    <Page.Resources>

        <converter:BooleanToVisibilityConverter x:Key="BoolToVisibility"/>

    </Page.Resources>


    <ScrollViewer HorizontalScrollBarVisibility="Auto" 
                  VerticalScrollBarVisibility="Hidden">

        <Grid Background="{StaticResource BackgroundBrush}">
            <Grid.ChildrenTransitions>
                <TransitionCollection>
                    <EntranceThemeTransition/>
                </TransitionCollection>
            </Grid.ChildrenTransitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="140"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid>
                
                <controls:MainPanel/>

                    <ComboBox x:Name="usernameComboBox"
                              Style="{StaticResource UsersTransactionCombobox}"
                              ItemsSource="{Binding Users}" 
                              VerticalAlignment="Top"
                              HorizontalAlignment="Right" 
                              Margin="0,70,200,0"
                              SelectedItem="{Binding SelectedUser,Mode=TwoWay}" 
                              Grid.Column="1">

                    <i:Interaction.Behaviors>
                        <core:EventTriggerBehavior EventName="SelectionChanged">
                            <core:InvokeCommandAction Command="{Binding SelectionChangedUser}"/>
                        </core:EventTriggerBehavior>
                    </i:Interaction.Behaviors>

                </ComboBox>

                <StackPanel Orientation="Horizontal" 
                            VerticalAlignment="Center" 
                            HorizontalAlignment="Left"
                            Grid.Column="1"
                            Margin="280,35,0,0" 
                            Height="24">

                    <datepicker:DatePicker Background="{StaticResource BackgroundBrush}"
                                           Style="{StaticResource CalendarStyle}" 
                                           Date="{Binding ThisDate,Mode=TwoWay}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="SelectionChanged">
                                <core:InvokeCommandAction Command="{Binding DateChangeCommand}"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </datepicker:DatePicker>

                    <TextBlock Text="-" 
                               FontSize="20" 
                               Grid.Column="1"  
                               VerticalAlignment="Center" 
                               HorizontalAlignment="Center"
                               Foreground="{StaticResource ForMainText}"
                               Visibility="{Binding Path = SecondDateVisibility,Mode=TwoWay,
                               Converter={StaticResource BoolToVisibility}}"/>

                    <datepicker:DatePicker Background="{StaticResource BackgroundBrush}" 
                                           Style="{StaticResource CalendarStyle}" 
                                           Date="{Binding SecondDate,Mode=TwoWay}"
                                           Visibility="{Binding Path = SecondDateVisibility,Mode=TwoWay,
                                           Converter={StaticResource BoolToVisibility}}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="SelectionChanged">
                                <core:InvokeCommandAction Command="{Binding SecondDateChangeCommand}"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </datepicker:DatePicker>

                </StackPanel>

            </Grid>

            <StackPanel Margin="0,140,0,0" Grid.RowSpan="2">

                <StackPanel Orientation="Horizontal" Margin="100,0,0,0">

                    <RadioButton x:Uid="daytitle"
                                 Command="{Binding DayCommand}" 
                                 Style="{StaticResource TextBlockButtonStyle1}"
                                 Margin="20,0,0,0"/>

                    <RadioButton x:Uid="weektitle"
                                 Command="{Binding WeekCommand}" 
                                 Style="{StaticResource TextBlockButtonStyle1}"
                                 Margin="20,0,0,0"/>

                    <RadioButton x:Uid="monthtitle"
                                 Command="{Binding MonthCommand}"
                                 Style="{StaticResource TextBlockButtonStyle1}"
                                 IsChecked="True"
                                 Margin="20,0,0,0"/>

                    <RadioButton x:Uid="yeartitle"
                                 Command="{Binding YearCommand}" 
                                 Style="{StaticResource TextBlockButtonStyle1}"
                                 Margin="20,0,0,0"/>

                    <RadioButton x:Uid="periodtitle"
                                 Command="{Binding PeriodCommand}" 
                                 Style="{StaticResource TextBlockButtonStyle1}"
                                 Margin="20,0,0,0"/>

                </StackPanel>

            </StackPanel>


            <StackPanel Orientation="Horizontal" Grid.Row="1" >

                <TextBlock x:Uid="balance"
                           Width="400"
                           Margin="120,20,0,0"
                           Style="{StaticResource HeaderTextBlockStyle}" 
                           FontSize="40"
                           Foreground="{StaticResource ForMainText}"/>

                <TextBlock x:Uid="IncomeTitle"
                           Width="390"
                           Margin="0,20,0,0"
                           Style="{StaticResource HeaderTextBlockStyle}" 
                           FontSize="40"
                           Foreground="{StaticResource ForMainText}"/>

                <TextBlock x:Uid="ExpensesTitle"
                           Margin="0,20,0,0"
                           Style="{StaticResource HeaderTextBlockStyle}" 
                           FontSize="40"
                           Foreground="{StaticResource ForMainText}"/>

            </StackPanel>

            <Grid Margin="-20,119,-10,0" Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition Width="616*"/>
                    <ColumnDefinition Width="4*"/>
                    <ColumnDefinition Width="775*"/>
                </Grid.ColumnDefinitions>

                <StackPanel Orientation="Horizontal" 
                            VerticalAlignment="Top" 
                            Margin="0,-66,0,28"  
                            Visibility="{Binding Visibilitydohnut,Mode=TwoWay,
                            Converter={StaticResource BoolToVisibility}}" 
                            Grid.ColumnSpan="4" >

                    <Grid>

                        <StackPanel Orientation="Vertical" Margin="80,0,0,100">

                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="125*"/>
                                    <ColumnDefinition Width="262*"/>
                                </Grid.ColumnDefinitions>
                                <charting:Chart x:Name="PieChart" 
                                                Width="387"
                                                Height="380" Grid.ColumnSpan="2" >
                                    <charting:Chart.Palette>

                                        <charting:ResourceDictionaryCollection>

                                            <ResourceDictionary>
                                                <SolidColorBrush x:Key="ForIncomeChart"  Color="#5200E1" />
                                                <Style x:Key="DataPointStyle" TargetType="Control">
                                                    <Setter Property="Background" Value="{StaticResource ForIncomeChart}" />
                                                </Style>
                                            </ResourceDictionary>

                                            <ResourceDictionary>
                                                <SolidColorBrush x:Key="ForExpenseChart"  Color="#F20E57" />
                                                <Style x:Key="DataPointStyle" TargetType="Control">
                                                    <Setter Property="Background" Value="{StaticResource ForExpenseChart}" />
                                                </Style>
                                            </ResourceDictionary>

                                        </charting:ResourceDictionaryCollection>

                                    </charting:Chart.Palette>

                                    <charting:Chart.LegendStyle>
                                        <Style TargetType="datavis:Legend">
                                            <Setter Property="Width" Value="0"/>
                                            <Setter Property="Height" Value="0"/>
                                        </Style>
                                    </charting:Chart.LegendStyle>

                                    <charting:Chart.Series>
                                        <charting:PieSeries Title="All user`s balans"
                                                            ItemsSource="{Binding Path=Categories}"
                                                            IndependentValueBinding="{Binding Name}"
                                                            DependentValueBinding="{Binding StatisticType}"
                                                            IsSelectionEnabled="False" />
                                    </charting:Chart.Series>

                                </charting:Chart>

                                <Grid HorizontalAlignment="Center" VerticalAlignment="Center" Margin="55,62,55,41" Grid.ColumnSpan="2">

                                    <Ellipse Fill="Gray"
                                             Width="277"
                                             Height="277"
                                             Opacity=".6"
                                             Visibility="{Binding Path = AllBudgetVisibility,Mode=TwoWay,
                                             Converter={StaticResource BoolToVisibility}}"/>

                                    <Ellipse Fill="Black"
                                             Width="150"
                                             Height="150"
                                             Opacity=".2"/>

                                    <Ellipse Fill="{StaticResource ForChartBackGround}"
                                             Width="130"
                                             Height="130"/>

                                </Grid>

                            </Grid>

                            <StackPanel Orientation="Horizontal" 
                                        HorizontalAlignment="Center"
                                        Margin="-20,0,0,0">

                                <StackPanel Orientation="Vertical" HorizontalAlignment="Center" >

                                    <StackPanel Orientation="Horizontal" Margin="0,-20,0,0" >

                                        <Grid>

                                            <Ellipse Fill="{StaticResource ForExpenseChart}"
                                                     Stretch="UniformToFill"
                                                     Height="50"
                                                     Width="50" />

                                            <ContentControl Style="{StaticResource ExpenseArrow}" 
                                                            Width="25"
                                                            Height="25"/>

                                        </Grid>

                                        <TextBlock x:Uid="ExpensesTitle"
                                                   Margin="20,12,0,0" 
                                                   Width="100" 
                                                   FontSize="20" 
                                                   Foreground="#5B5B5B"/>

                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal"  Margin="0,20,0,0" >

                                        <Grid >

                                            <Ellipse Fill="{StaticResource ForIncomeChart}"
                                                     Stretch="UniformToFill"
                                                     Height="50" 
                                                     Width="50" />

                                            <ContentControl Style="{StaticResource IncomeArrow}"
                                                            Width="25"
                                                            Height="25"/>

                                        </Grid>

                                        <TextBlock x:Uid="IncomeTitle"
                                                   Margin="20,12,0,0" 
                                                   Width="100" 
                                                   FontSize="20"
                                                   Foreground="#5B5B5B"/>

                                    </StackPanel>

                                </StackPanel>

                                <StackPanel Orientation="Vertical"  HorizontalAlignment="Center" >

                                    <StackPanel Orientation="Horizontal" Margin="0,-18,0,0">

                                        <TextBlock Text="$"
                                                   Margin="0,12,0,0"
                                                   FontSize="20"
                                                   Foreground="{StaticResource ForExpenseChart}"/>

                                        <TextBlock Text="{Binding SelectedUser.Expense}"
                                                   Margin="2,12,0,0" 
                                                   FontSize="20"
                                                   Foreground="{StaticResource ForExpenseChart}"/>

                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal" Margin="0,34,0,0">

                                        <TextBlock Text="$"  
                                                   Margin="0,12,0,0" 
                                                   FontSize="20"
                                                   Foreground="{StaticResource ForIncomeChart}"/>

                                        <TextBlock Text="{Binding SelectedUser.Income}" 
                                                   Margin="2,12,0,0"
                                                   FontSize="20" 
                                                   Foreground="{StaticResource ForIncomeChart}"/>

                                    </StackPanel>

                                </StackPanel>

                            </StackPanel>

                        </StackPanel>

                    </Grid>

                    <Grid  Margin="0,-40,0,150">

                        <charting:Chart x:Name="PieChartIncome" 
                                            Width="387"
                                            Height="380"
                                            Margin="40,0,0,0">

                            <charting:Chart.LegendStyle>

                                <Style TargetType="datavis:Legend">
                                    <Setter Property="Foreground" Value="{StaticResource ForMainText}"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>

                            </charting:Chart.LegendStyle>

                            <charting:Chart.Series>
                                <charting:PieSeries Title="All user`s income"
                                                        ItemsSource="{Binding Path=SelectedUser.Categoriesincome}"
                                                        IndependentValueBinding="{Binding Name}"
                                                        DependentValueBinding="{Binding StatisticType}"
                                                        IsSelectionEnabled="False" />

                            </charting:Chart.Series>

                        </charting:Chart>

                        <Grid HorizontalAlignment="Center"
                              VerticalAlignment="Center"  
                              Margin="-10,10,0,0">

                            <Ellipse Fill="Gray"
                                     Width="275"
                                     Height="275"
                                     Opacity=".6"
                                     Visibility="{Binding Path = IncomesVisibility,Mode=TwoWay,
                                     Converter={StaticResource BoolToVisibility}}"/>

                            <Ellipse Fill="Black" 
                                     Width="150"
                                     Height="150"
                                     Opacity=".2"/>
                            <Grid>

                                <Ellipse Fill="{StaticResource ForChartBackGround}"
                                         Width="130"
                                         Height="130"/>

                                <StackPanel Orientation="Vertical"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center">

                                    <TextBlock Text="{Binding Output}" 
                                               FontSize=" 18" 
                                               Foreground="{StaticResource ForMainText}"/>

                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                                        <TextBlock Text="$"
                                                   FontSize="18"
                                                   Foreground="{StaticResource ForMainText}"/>

                                        <TextBlock Text="{Binding UserIncome}"
                                                   FontSize="18"
                                                   Foreground="{StaticResource ForMainText}"/>

                                    </StackPanel>

                                </StackPanel>

                            </Grid>

                        </Grid>


                    </Grid>

                    <Grid  Margin="0,-40,0,150">

                        <charting:Chart x:Name="PieChartExpense" 
                                        Width="387"
                                        Height="387"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Margin="50,-20,0,0">

                            <charting:Chart.LegendStyle>

                                <Style TargetType="datavis:Legend">
                                    <Setter Property="Foreground" Value="{StaticResource ForMainText}"/>
                                    <Setter Property="VerticalAlignment" Value="Center"/>
                                </Style>

                            </charting:Chart.LegendStyle>

                            <charting:Chart.Series>
                                <charting:PieSeries Title="All user`s expense"
                                                    ItemsSource="{Binding Path=SelectedUser.Categoriesexpense}"
                                                    IndependentValueBinding="{Binding Name}"
                                                    DependentValueBinding="{Binding StatisticType}"
                                                    IsSelectionEnabled="False" />

                            </charting:Chart.Series>

                        </charting:Chart>

                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">

                            <Ellipse Fill="Gray"
                                     Width="275"
                                     Height="275"
                                     Opacity=".6"
                                     Visibility="{Binding Path = ExpensesVisibility,Mode=TwoWay,
                                     Converter={StaticResource BoolToVisibility}}"/>

                            <Ellipse Fill="Black" 
                                     Width="150"
                                     Height="150"
                                     Opacity=".2"/>
                            <Grid>

                                <Ellipse Fill="{StaticResource ForChartBackGround}"
                                         Width="130"
                                         Height="130"/>

                                <StackPanel Orientation="Vertical"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Center">

                                    <TextBlock Text="{Binding Output}" 
                                               FontSize=" 18" 
                                               Foreground="{StaticResource ForMainText}"/>

                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">

                                        <TextBlock Text="$"
                                                   FontSize="18" 
                                                   Foreground="{StaticResource ForMainText}"/>

                                        <TextBlock Text="{Binding UserExpense}"
                                                   FontSize="18" 
                                                   Foreground="{StaticResource ForMainText}"/>

                                    </StackPanel>

                                </StackPanel>

                            </Grid>

                        </Grid>

                    </Grid>

                </StackPanel>
                <StackPanel Orientation="Horizontal"
                            VerticalAlignment="Top"
                            Visibility="{Binding Visibilitycolumn,Mode=TwoWay,
                    Converter={StaticResource BoolToVisibility}}" 
                            Height="525"
                            Grid.ColumnSpan="4" 
                            Margin="80,-100,0,0">

                    <charting:Chart x:Name="ColumnChart" 
                                    Margin="30,0,0,0"
                                    Width="387" 
                                    Height="450"
                                    Foreground="{StaticResource ForMainText}">

                        <charting:Chart.LegendStyle>

                            <Style TargetType="datavis:Legend">
                                <Setter Property="Width" Value="0"/>
                                <Setter Property="Height" Value="0"/>
                            </Style>

                        </charting:Chart.LegendStyle>

                        <charting:Chart.Series>

                            <charting:ColumnSeries ItemsSource="{Binding Path=Categories}"
                                                   IndependentValueBinding="{Binding Name}"
                                                   DependentValueBinding="{Binding StatisticType}"
                                                   IsSelectionEnabled="False" />

                        </charting:Chart.Series>

                    </charting:Chart>

                    <charting:Chart x:Name="ColumnChartIncome" 
                                    Margin="30,0,0,0"
                                    Width="387" 
                                    Height="450"
                                    Foreground="{StaticResource ForMainText}">

                        <charting:Chart.Palette>

                            <charting:ResourceDictionaryCollection>

                                <ResourceDictionary>
                                    <SolidColorBrush x:Key="ForIncomeChart"  Color="#F20E57" />
                                    <Style x:Key="DataPointStyle" TargetType="Control">
                                        <Setter Property="Background" Value="{StaticResource ForIncomeChart}" />
                                    </Style>
                                </ResourceDictionary>

                            </charting:ResourceDictionaryCollection>

                        </charting:Chart.Palette>

                        <charting:Chart.LegendStyle>
                            <Style TargetType="datavis:Legend">
                                <Setter Property="Width" Value="0"/>
                                <Setter Property="Height" Value="0"/>
                            </Style>
                        </charting:Chart.LegendStyle>

                        <charting:Chart.Series>

                            <charting:ColumnSeries ItemsSource="{Binding Path=SelectedUser.Categoriesincome}"
                                                   IndependentValueBinding="{Binding Name}"
                                                   DependentValueBinding="{Binding StatisticType}"
                                                   IsSelectionEnabled="False" />
                        </charting:Chart.Series>

                    </charting:Chart>

                    <charting:Chart x:Name="ColumnChartExpense" 
                                    Margin="30,0,0,0"
                                    Width="387" 
                                    Height="450"
                                    Foreground="{StaticResource ForMainText}">

                        <charting:Chart.Palette>

                            <charting:ResourceDictionaryCollection>

                                <ResourceDictionary>
                                    <SolidColorBrush x:Key="ForExpenseChart"  Color="#5200E1" />
                                    <Style x:Key="DataPointStyle" TargetType="Control">
                                        <Setter Property="Background" Value="{StaticResource ForExpenseChart}" />
                                    </Style>
                                </ResourceDictionary>

                            </charting:ResourceDictionaryCollection>

                        </charting:Chart.Palette>

                        <charting:Chart.LegendStyle>
                            <Style TargetType="datavis:Legend">
                                <Setter Property="Width" Value="0"/>
                                <Setter Property="Height" Value="0"/>
                            </Style>
                        </charting:Chart.LegendStyle>

                        <charting:Chart.Series>
                            <charting:ColumnSeries ItemsSource="{Binding Path=SelectedUser.Categoriesexpense}"
                                                   IndependentValueBinding="{Binding Name}"
                                                   DependentValueBinding="{Binding StatisticType}"
                                                   IsSelectionEnabled="False" />

                        </charting:Chart.Series>

                    </charting:Chart>

                </StackPanel>

                <StackPanel Orientation="Horizontal" 
                            Margin="100,0,0,60" 
                            Grid.ColumnSpan="3"
                            VerticalAlignment="Bottom"
                            HorizontalAlignment="Center"
                            Grid.Column="1" >

                    <Button  Width="200" 
                             x:Uid="categories"
                             Height="34"
                             Style="{StaticResource PressedStyle1}"  />

                    <Button   Width="200"
                              x:Uid="cash"
                              Style="{StaticResource UnpressedStyle1}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="Click">
                                <core:NavigateToPageAction TargetPage="BudgetManager.WindowsBudget.Views.Statistic.Graphic"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </Button>

                    <Button  Width="200" 
                             x:Uid="circles"
                             Margin="100,0,0,0"
                             IsEnabled="{Binding Enabledohnut}" 
                             Style="{StaticResource UnpressedStyle1}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="Click">
                                <core:InvokeCommandAction Command="{Binding SelectedDohnutChartCommand}"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </Button>

                    <Button   Width="200"
                              x:Uid="columns"
                              IsEnabled="{Binding Enablecolumn}"
                              Style="{StaticResource UnpressedStyle1}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="Click">
                                <core:InvokeCommandAction Command="{Binding SelectColumnChartCommand}"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </Button>

                </StackPanel>

            </Grid>

        </Grid>

    </ScrollViewer>

</common:ViewBase>

