<common:ViewBase
    x:Name="pageRoot"
    x:Class="BudgetManager.WindowsBudget.Views.AddTransaction.AddTransactionExpense"
    xmlns:VM="using:BudgetManager.Shared"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:BudgetManager.WindowsBudget.Views.AddTransaction"
    xmlns:common="using:BudgetManager.WindowsBudget.Common"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:mybehaviors="using:BudgetManager.WindowsBudget.Behaviors"
    DataContext="{Binding Source={StaticResource Locator}, Path=AddTransactionViewModel}"
    xmlns:converter="using:BudgetManager.Core.Converters"
    xmlns:controls="using:BudgetManager.WindowsBudget.Views.Controls"
    mc:Ignorable="d">

    <Page.Resources>
 
        <converter:BooleanToVisibilityConverter x:Key="BoolToVisibility"/>
        
    </Page.Resources>

    <ScrollViewer HorizontalScrollBarVisibility="Auto" Background="{StaticResource ForAppBarBrush}" VerticalScrollBarVisibility="Disabled">

        <Grid Background="{StaticResource BackgroundBrush}">
            <Grid.ChildrenTransitions>
                <TransitionCollection>
                    <EntranceThemeTransition/>
                </TransitionCollection>
            </Grid.ChildrenTransitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="140"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <ContentControl Style="{StaticResource CoinImage}" Grid.Row="2"/>

            <controls:MainPanel/>

            <StackPanel Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,20,20,0" 
                    VerticalAlignment="Center">

                <Button x:Uid="expenseButton"
                    Command="{Binding ExpenseClick}"
                    Style="{StaticResource UnpressedStyle1}"
                    IsEnabled="{Binding EnableExpense}"/>

                <Button x:Uid="incomeButton"
                    IsEnabled="{Binding EnableIncome}"
                    Command="{Binding IncomeClick}"
                    Style="{StaticResource UnpressedStyle1}"/>

                <Button x:Uid="sendingButton"
                    IsEnabled="{Binding EnableSending}"
                    Command="{Binding  SendingClick}"
                    Style="{StaticResource UnpressedStyle1}"/>

            </StackPanel>

            <StackPanel Orientation="Vertical" 
                        Grid.RowSpan="2"
                        VerticalAlignment="Top"
                        HorizontalAlignment="Left"
                        Margin="120,0,0,0" 
                        Grid.Row="1"          
                        Width="360">

                    <TextBlock x:Uid="addNameTextBlock"
                               Style="{StaticResource BasicTextBlock}" />

                    <controls:ExtendedTextBoxForNames FontSize="25" 
                                                      Margin="0,0,10,0"
                                                      Style="{StaticResource BasicTextBox}"  
                                                      Text="{Binding NewName, Mode=TwoWay}"/>

                    <TextBlock x:Uid="addcategoryTextBlock"
                               Style="{StaticResource BasicTextBlock}"
                               Visibility="{Binding Path = VisibilityOfExpenseFields,Mode=TwoWay,
                        Converter={StaticResource BoolToVisibility}}"/>

                <ComboBox x:Name="CategoriesExpense"
                          Margin="0,0,10,0"
                          Style="{StaticResource CategoriesexpenseCombobox}" 
                          ItemsSource="{Binding Path = NewUser.Categoriesexpense}" 
                          SelectedItem="{Binding SelectedCategory,Mode=TwoWay}" 
                          Visibility="{Binding Path = VisibilityOfExpenseFields,Mode=TwoWay,
                          Converter={StaticResource BoolToVisibility}}">

                </ComboBox>

                    <StackPanel Orientation="Horizontal" 
                                Margin="0,0,10,0"
                                Visibility="{Binding Path = VisibilityOfExpenseFields,Mode=TwoWay,
                            Converter={StaticResource BoolToVisibility}}">

                        <TextBlock x:Uid="addsumTextBlock"
                                   Style="{StaticResource BasicTextBlock}" 
                                   Width="177" />

                        <TextBlock x:Uid="restTextBlock"
                                   Style="{StaticResource BasicTextBlock}"
                                   Width="118" />

                    </StackPanel>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,0,10,0"
                                Visibility="{Binding Path = VisibilityOfExpenseFields,Mode=TwoWay,
                            Converter={StaticResource BoolToVisibility}}">

                        <TextBox x:Name="Sum"
                                 Margin="0,0,10,0"
                                 Style="{StaticResource BasicTextBox}" 
                                 Text="{Binding NewCount, Mode=TwoWay}"
                                 Width="168">

                            <i:Interaction.Behaviors>
                                <mybehaviors:NumericTextBox/>
                                <core:EventTriggerBehavior EventName="LostFocus">
                                    <core:InvokeCommandAction Command="{Binding TextChange}"/>
                                </core:EventTriggerBehavior>
                            </i:Interaction.Behaviors>

                        </TextBox>

                        <TextBox x:Name="Rest"
                                 Margin="0,0,10,0"
                                 Style="{StaticResource BasicTextBox}"
                                 Text="{Binding Rest}"
                                 Width="171" 
                                 IsReadOnly="True"  />

                    </StackPanel>

                    <TextBlock x:Uid="addcategoryTextBlock"
                               Style="{StaticResource BasicTextBlock}"
                               Visibility="{Binding Path = VisibilityOfIncomeFields,Mode=TwoWay,
                           Converter={StaticResource BoolToVisibility}}"/>

                <ComboBox x:Name="CategoriesIncome"
                              Margin="0,0,10,0"
                              Style="{StaticResource CategoriesIncomeCombobox}" 
                              ItemsSource="{Binding Path = NewUser.Categoriesincome}"                    
                              SelectedItem="{Binding SelectedCategory,Mode=TwoWay}"
                              Visibility="{Binding Path = VisibilityOfIncomeFields,Mode=TwoWay,
                          Converter={StaticResource BoolToVisibility}}">
                </ComboBox>

                    <TextBlock x:Uid="addsumTextBlock"
                               Style="{StaticResource BasicTextBlock}" 
                               Width="162"
                               HorizontalAlignment="Left" 
                               Visibility="{Binding Path = VisibilityOfIncomeFields,Mode=TwoWay,
                           Converter={StaticResource BoolToVisibility}}"/>

                    <TextBox x:Name="SumIncome"
                             Style="{StaticResource BasicTextBox}" 
                             Text="{Binding NewCount, Mode=TwoWay}"
                             HorizontalAlignment="Left"
                             Width="350"
                             Visibility="{Binding Path = VisibilityOfIncomeFields,Mode=TwoWay,
                         Converter={StaticResource BoolToVisibility}}">

                        <i:Interaction.Behaviors>
                            <mybehaviors:NumericTextBox/>
                        </i:Interaction.Behaviors>

                    </TextBox>

                    <TextBlock x:Uid="onMoneyAccountTextBlock"
                               Style="{StaticResource BasicTextBlock}" 
                               Visibility="{Binding Path = VisibilityOfSendingFields,Mode=TwoWay,
                           Converter={StaticResource BoolToVisibility}}"/>

                    <ComboBox x:Name="Accountsender" 
                              Margin="0,0,10,0"  
                              Style="{StaticResource BasicComboBox}" 
                              ItemsSource="{Binding Path = NewUser.Categoriesaccount}"
                              SelectedItem="{Binding SelectedCategory,Mode=TwoWay}"
                              Visibility="{Binding Path = VisibilityOfSendingFields,Mode=TwoWay,
                          Converter={StaticResource BoolToVisibility}}">
                    </ComboBox>

                    <StackPanel Orientation="Horizontal"
                                Margin="0,0,10,0"
                                Visibility="{Binding Path = VisibilityOfSendingFields,Mode=TwoWay,
                            Converter={StaticResource BoolToVisibility}}">

                        <TextBlock x:Uid="addsumTextBlock"
                                   Style="{StaticResource BasicTextBlock}"
                                   Width="177" />

                        <TextBlock x:Uid="restTextBlock"
                                   Style="{StaticResource BasicTextBlock}" 
                                   Width="115" />

                    </StackPanel>

                    <StackPanel Orientation="Horizontal" 
                                Margin="0,0,10,0"
                                Visibility="{Binding Path = VisibilityOfSendingFields,Mode=TwoWay,
                            Converter={StaticResource BoolToVisibility}}">

                        <TextBox x:Name="SumAccount"  
                                 Margin="0,0,10,0" 
                                 Style="{StaticResource BasicTextBox}" 
                                 Text="{Binding NewCount, Mode=TwoWay}" 
                                 Width="168" >

                            <i:Interaction.Behaviors>
                                <mybehaviors:NumericTextBox/>
                                <core:EventTriggerBehavior EventName="LostFocus">
                                    <core:InvokeCommandAction Command="{Binding TextChange}"/>
                                </core:EventTriggerBehavior>
                            </i:Interaction.Behaviors>

                        </TextBox>

                        <TextBox x:Name="RestAccount" 
                                 Margin="0,0,10,0"
                                 Style="{StaticResource BasicTextBox}" 
                                 Text="{Binding Rest}"
                                 Width="170" 
                                 IsReadOnly="True"/>

                    </StackPanel>

                    <TextBlock x:Uid="addAccountTextBlock"
                               Style="{StaticResource BasicTextBlock}" />

                    <ComboBox x:Name="Usernamereciever" 
                              Height="35"
                              Margin="0,0,10,0" 
                              Style="{StaticResource userCombobox}"
                              ItemsSource="{Binding Users}"
                              SelectedItem="{Binding NewUser,Mode=TwoWay}">
                    </ComboBox>

                    <TextBlock x:Uid="accountTextBlock"
                               Style="{StaticResource BasicTextBlock}" />

                    <ComboBox x:Name="MoneyAccount"
                              Margin="0,0,10,0"
                              Style="{StaticResource MoneyAccountCombobox}"
                              ItemsSource="{Binding Path = NewUser.Categoriesaccount}" 
                              SelectedItem="{Binding SelectedMoneyAccount,Mode=TwoWay}">

                        <i:Interaction.Behaviors>
                            <core:EventTriggerBehavior EventName="SelectionChanged">
                                <core:InvokeCommandAction Command="{Binding SelectionRest}"/>
                            </core:EventTriggerBehavior>
                        </i:Interaction.Behaviors>

                    </ComboBox>

                    <StackPanel Orientation="Horizontal">

                        <TextBlock x:Uid="dateTextBlock"
                                   Style="{StaticResource BasicTextBlock}" 
                                   Width="94" />

                    </StackPanel>


                <controls:ExtendedDatePanel/>


                    <Button x:Name="UpdateAccount"
                            x:Uid="saveButton"
                            Width="358"
                            Command="{Binding AddTransactionClick}"  
                            Style ="{StaticResource AddButtonStyle}" 
                            Margin="-2,20,0,0"/>


                </StackPanel>

        </Grid>

    </ScrollViewer>
    
</common:ViewBase>


